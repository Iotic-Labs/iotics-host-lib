; https://tox.readthedocs.io/en/latest/config.html
[tox]
envlist = flake8,pylint,py3
skipsdist = True


[testenv:flake8]
deps = -e ./src/[lint]
       -e ./testing/[lint]
commands = flake8 src/iotics ./testing/iotics
           flake8 src/tests


[flake8]
exclude = venv env *.egg-info .git .tox


[testenv:pylint]
deps = -e ./testing/[lint]
       -e ./src/[lint,test]
commands = pylint --rcfile .pylint.rc ./src/iotics
           pylint --rcfile .pylint.rc ./src/tests --disable=W0621,W0613,E1101,R0903


[testenv:py3]
deps = -e ./testing/
       -e ./src/[test]
setenv =
  PYTHONDONTWRITEBYTECODE = 1
commands = pytest -vv -o console_output_style=count --durations=10 \
           --cov --cov-report html --cov-report xml \
           --junitxml=test-unit-results.xml --html=res/unit/index.html {posargs}


; https://docs.pytest.org/en/latest/reference.html#configuration-options
[pytest]
testpaths = src/tests
python_files = tests.py test_*.py *_tests.py
junit_family = xunit2


; https://coverage.readthedocs.io/en/latest/config.html
[coverage:run]
source = src/iotics
branch = True


[report]
show_missing = True
